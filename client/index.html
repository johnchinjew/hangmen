<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Hangmen</title>
    <script src="./client.js"></script>
    <script src="/socket.io/socket.io.js"></script>
</head>

<body>
    <script>
        const app = Elm.Main.init();
        const socket = io(); // TODO: Detect connection error

        app.ports.toSocket.subscribe((event) => {
            if (event.tag == 'create-game')
                socket.emit(event.tag, event.name)
            else if (event.tag == 'join-game')
                socket.emit(event.tag, event.pin, event.name)
            else if (event.tag == 'start-game')
                socket.emit(event.tag, event.word)
            else if (event.tag == 'guess-letter')
                socket.emit(event.tag, event.letter)
            else if (event.tag == 'guess-word')
                socket.emit(event.tag, event.pin, event.word)
        });

        socket.on('game-update', (game) => {
            console.log('game-update')
            app.ports.fromSocket.send(game)
        });

        socket.on('join-successful', (pid) => {
            console.log('join-successful')
            app.ports.fromSocket.send(pid)
        })
    </script>
</body>

</html>